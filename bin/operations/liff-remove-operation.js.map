{"version":3,"sources":["../../lib/operations/liff-remove-operation.js"],"names":["LIFFRemoveOperation","Operation","usage","sections","header","help","content","code","run","validateConfig","prompts","require","apps","response","listRequest","send","data","error","console","length","log","info","choices","map","app","title","view","type","url","liffId","description","value","name","message","cancelOption","removeRequest","success","LIFFListRequest","accessToken","config","channel","LIFFRemoveRequest"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;AAEe,MAAMA,mBAAN,SAAkCC,kBAAlC,CAA4C;AAQzD,aAAWC,KAAX,GAAmB;AACjB;AACA,UAAMC,QAAQ,GAAG,CACf;AACEC,MAAAA,MAAM,EAAE,oBAAoBC,IAD9B;AAEEC,MAAAA,OAAO,EAAG,aAAD,CAAcC;AAFzB,KADe,CAAjB;AAOA,WAAOJ,QAAP;AACD;;AAED,eAAaK,GAAb,GAAmB;AACjB,QAAI,CAAC,KAAKC,cAAL,EAAL,EAA4B;AAC1B,aAAO,KAAP;AACD;;AAED,UAAMC,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AAEA,QAAIC,IAAI,GAAG,EAAX;;AAEA,QAAI;AACF,YAAMC,QAAQ,GAAG,MAAM,KAAKC,WAAL,CAAiBC,IAAjB,EAAvB;AAEAH,MAAAA,IAAI,GAAGC,QAAQ,CAACG,IAAT,CAAcJ,IAAd,IAAsB,EAA7B;AACD,KAJD,CAIE,OAAOK,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACA,aAAO,KAAP;AACD;;AAED,QAAI,CAACL,IAAI,CAACO,MAAV,EAAkB;AAChBD,MAAAA,OAAO,CAACE,GAAR,CAAY,qBAAqBC,IAAjC;AACA,aAAO,IAAP;AACD;;AAED,UAAMC,OAAO,GAAGV,IAAI,CAACW,GAAL,CAASC,GAAG,IAAI;AAC9B,aAAO;AACLC,QAAAA,KAAK,EAAG,GAAED,GAAG,CAACE,IAAJ,CAASC,IAAK,IAAGH,GAAG,CAACE,IAAJ,CAASE,GAAI,KAAIJ,GAAG,CAACK,MAAO,GADlD;AAELC,QAAAA,WAAW,EAAEN,GAAG,CAACM,WAFZ;AAGLC,QAAAA,KAAK,EAAEP,GAAG,CAACK;AAHN,OAAP;AAKD,KANe,CAAhB;AAQA,UAAM;AAAEA,MAAAA;AAAF,QAAa,MAAMnB,OAAO,CAC9B;AACEiB,MAAAA,IAAI,EAAE,QADR;AAEEK,MAAAA,IAAI,EAAE,QAFR;AAGEC,MAAAA,OAAO,EAAE,iCAHX;AAIEX,MAAAA;AAJF,KAD8B,EAO9B,KAAKY,YAPyB,CAAhC;;AAUA,QAAI;AACF,YAAM,KAAKC,aAAL,CAAmBpB,IAAnB,CAAwBc,MAAxB,CAAN;AACAX,MAAAA,OAAO,CAACE,GAAR,CAAa,wBAAuBS,MAAM,CAACtB,IAAK,EAApC,CAAsC6B,OAAlD;AACD,KAHD,CAGE,OAAOnB,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACA,aAAO,KAAP;AACD;;AAED,WAAO,IAAP;AACD;;AAtEwD;;;;gBAAtCjB,mB,iBACE,IAAIqC,wBAAJ,CAAoB;AACvCC,EAAAA,WAAW,EAFMtC,mBAEJ,CAAKuC,MAAL,CAAYC,OAAZ,CAAoBF;AADM,CAApB,C;;gBADFtC,mB,mBAII,IAAIyC,0BAAJ,CAAsB;AAC3CH,EAAAA,WAAW,EALMtC,mBAKJ,CAAKuC,MAAL,CAAYC,OAAZ,CAAoBF;AADU,CAAtB,C","sourcesContent":["import 'console.table';\nimport { Section } from 'command-line-usage';\nimport Operation from './operation';\nimport LIFFListRequest from '../apis/liff-list-request';\nimport LIFFRemoveRequest from '../apis/liff-remove-request';\n\nexport default class LIFFRemoveOperation extends Operation {\n  static listRequest = new LIFFListRequest({\n    accessToken: this.config.channel.accessToken\n  });\n  static removeRequest = new LIFFRemoveRequest({\n    accessToken: this.config.channel.accessToken\n  });\n\n  static get usage() {\n    /** @type {Section[]} */\n    const sections = [\n      {\n        header: 'Remove a LIFF app'.help,\n        content: `liff remove`.code\n      }\n    ];\n\n    return sections;\n  }\n\n  static async run() {\n    if (!this.validateConfig()) {\n      return false;\n    }\n\n    const prompts = require('prompts');\n\n    let apps = [];\n\n    try {\n      const response = await this.listRequest.send();\n\n      apps = response.data.apps || [];\n    } catch (error) {\n      console.error(error);\n      return false;\n    }\n\n    if (!apps.length) {\n      console.log('LIFF app not found'.info);\n      return true;\n    }\n\n    const choices = apps.map(app => {\n      return {\n        title: `${app.view.type} ${app.view.url} [${app.liffId}]`,\n        description: app.description,\n        value: app.liffId\n      };\n    });\n\n    const { liffId } = await prompts(\n      {\n        type: 'select',\n        name: 'liffId',\n        message: 'Select a LIFF app to be removed',\n        choices\n      },\n      this.cancelOption\n    );\n\n    try {\n      await this.removeRequest.send(liffId);\n      console.log(`Removed LIFF app ID: ${liffId.code}`.success);\n    } catch (error) {\n      console.error(error);\n      return false;\n    }\n\n    return true;\n  }\n}\n"],"file":"liff-remove-operation.js"}