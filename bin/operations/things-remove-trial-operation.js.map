{"version":3,"sources":["../../lib/operations/things-remove-trial-operation.js"],"names":["ThingsRemoveTrialOperation","Operation","usage","sections","header","help","content","code","run","validateConfig","prompts","require","trialProducts","response","listRequest","send","data","error","console","length","map","product","title","name","description","id","value","log","info","productId","type","message","choices","cancelOption","removeRequest","success","ThingsListTrialProductsRequest","accessToken","config","channel","ThingsRemoveTrialProductRequest"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;;AAEA;;AACA;;;;;;AAEe,MAAMA,0BAAN,SAAyCC,kBAAzC,CAAmD;AAQhE,aAAWC,KAAX,GAAmB;AACjB;AACA,UAAMC,QAAQ,GAAG,CACf;AACEC,MAAAA,MAAM,EAAE,yBAAyBC,IADnC;AAEEC,MAAAA,OAAO,EAAG,qBAAD,CAAsBC;AAFjC,KADe,CAAjB;AAOA,WAAOJ,QAAP;AACD;;AAED,eAAaK,GAAb,GAAmB;AACjB,QAAI,CAAC,KAAKC,cAAL,EAAL,EAA4B;AAC1B,aAAO,KAAP;AACD;;AAED,UAAMC,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AAEA,QAAIC,aAAJ;;AAEA,QAAI;AACF,YAAMC,QAAQ,GAAG,MAAM,KAAKC,WAAL,CAAiBC,IAAjB,EAAvB;AAEAH,MAAAA,aAAa,GAAGC,QAAQ,CAACG,IAAzB;AACD,KAJD,CAIE,OAAOC,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACA,aAAO,KAAP;AACD;;AAED,QAAIL,aAAa,IAAIA,aAAa,CAACO,MAAnC,EAA2C;AACzCP,MAAAA,aAAa,GAAGA,aAAa,CAACQ,GAAd,CAAkBC,OAAO,IAAI;AAC3C,eAAO;AACLC,UAAAA,KAAK,EAAG,GAAED,OAAO,CAACE,IAAK,EADlB;AAELC,UAAAA,WAAW,EAAG,eAAcH,OAAO,CAACI,EAAG,EAFlC;AAGLC,UAAAA,KAAK,EAAEL,OAAO,CAACI;AAHV,SAAP;AAKD,OANe,CAAhB;AAOD,KARD,MAQO;AACLP,MAAAA,OAAO,CAACS,GAAR,CAAY,0BAA0BC,IAAtC;AACA,aAAO,IAAP;AACD;;AAED,UAAM;AAAEC,MAAAA;AAAF,QAAgB,MAAMnB,OAAO,CACjC;AACEoB,MAAAA,IAAI,EAAE,QADR;AAEEP,MAAAA,IAAI,EAAE,WAFR;AAGEQ,MAAAA,OAAO,EAAE,sCAHX;AAIEC,MAAAA,OAAO,EAAEpB;AAJX,KADiC,EAOjC,KAAKqB,YAP4B,CAAnC;;AAUA,QAAI;AACF,YAAM,KAAKC,aAAL,CAAmBnB,IAAnB,CAAwBc,SAAxB,CAAN;AACAX,MAAAA,OAAO,CAACS,GAAR,CAAa,6BAA4BE,SAAS,CAACtB,IAAK,EAA5C,CAA8C4B,OAA1D;AACD,KAHD,CAGE,OAAOlB,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACA,aAAO,KAAP;AACD;;AAED,WAAO,IAAP;AACD;;AAtE+D;;;;gBAA7CjB,0B,iBACE,IAAIoC,uCAAJ,CAAmC;AACtDC,EAAAA,WAAW,EAFMrC,0BAEJ,CAAKsC,MAAL,CAAYC,OAAZ,CAAoBF;AADqB,CAAnC,C;;gBADFrC,0B,mBAII,IAAIwC,wCAAJ,CAAoC;AACzDH,EAAAA,WAAW,EALMrC,0BAKJ,CAAKsC,MAAL,CAAYC,OAAZ,CAAoBF;AADwB,CAApC,C","sourcesContent":["import 'console.table';\nimport { Section } from 'command-line-usage';\n\nimport Operation from './operation';\n\nimport ThingsListTrialProductsRequest from '../apis/things-list-trial-products-request';\nimport ThingsRemoveTrialProductRequest from '../apis/things-remove-trial-product-request';\n\nexport default class ThingsRemoveTrialOperation extends Operation {\n  static listRequest = new ThingsListTrialProductsRequest({\n    accessToken: this.config.channel.accessToken\n  });\n  static removeRequest = new ThingsRemoveTrialProductRequest({\n    accessToken: this.config.channel.accessToken\n  });\n\n  static get usage() {\n    /** @type {Section[]} */\n    const sections = [\n      {\n        header: 'Remove a trial product'.help,\n        content: `things remove:trial`.code\n      }\n    ];\n\n    return sections;\n  }\n\n  static async run() {\n    if (!this.validateConfig()) {\n      return false;\n    }\n\n    const prompts = require('prompts');\n\n    let trialProducts;\n\n    try {\n      const response = await this.listRequest.send();\n\n      trialProducts = response.data;\n    } catch (error) {\n      console.error(error);\n      return false;\n    }\n\n    if (trialProducts && trialProducts.length) {\n      trialProducts = trialProducts.map(product => {\n        return {\n          title: `${product.name}`,\n          description: `Product ID: ${product.id}`,\n          value: product.id\n        };\n      });\n    } else {\n      console.log('Trial product not found'.info);\n      return true;\n    }\n\n    const { productId } = await prompts(\n      {\n        type: 'select',\n        name: 'productId',\n        message: 'Select a trial product to be removed',\n        choices: trialProducts\n      },\n      this.cancelOption\n    );\n\n    try {\n      await this.removeRequest.send(productId);\n      console.log(`Removed trial product ID: ${productId.code}`.success);\n    } catch (error) {\n      console.error(error);\n      return false;\n    }\n\n    return true;\n  }\n}\n"],"file":"things-remove-trial-operation.js"}